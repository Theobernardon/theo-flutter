name: Test et Analyse Flutter Workflow R√©utilisable

on:
  workflow_call:

jobs:
  # Dans un premier temps on fait l'analyse du code et les tests unitaires
  Analyse-et-tests:
    name: üö¶
    # D√©finit les syst√®mes d'exploitation sur lesquels ex√©cuter le job
    runs-on: ubuntu-latest
    steps:
      # 1Ô∏è‚É£ - Cloner ton code source
      - name: "Checkout code"
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ - Installer Flutter avec pubspec.yaml, et cache automatique
      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: stable # Utilise le canal stable pour la version de Flutter
          flutter-version-file: pubspec.yaml
          cache: true # Active le cache pub + flutter automatiquement

      # 3Ô∏è‚É£ - R√©cup√©rer les d√©pendances Dart/Flutter
      - name: "Install dependencies"
        run: flutter pub get

      # 4Ô∏è‚É£ - V√©rifier que le code est propre (analyse statique)
      - id: Analyze-code
        run: flutter analyze

      # 5Ô∏è‚É£ - Lancer les tests unitaires
      - id: Run-tests
        run: flutter test
