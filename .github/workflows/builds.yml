name: Builder Flutter Workflow Réutilisable

on:
  workflow_call:
    # Map the workflow outputs to job outputs
    inputs:
      platforms:
        required: true
        type: string
        description: "Liste des plateformes à builder, séparées par des virgules (ex: apk, ios, web)"
      mode:
        required: true
        type: string
        description: "release ou debug"

jobs:
  windows:
    if: contains(inputs.platforms, 'windows')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: windows
      os: windows-latest
      mode: ${{ inputs.mode }} # release ou debug

  linux:
    if: contains(inputs.platforms, 'linux')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: linux
      os: ubuntu-latest
      mode: ${{ inputs.mode }}

  macos:
    if: contains(inputs.platforms, 'macos')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: macos
      os: macos-latest
      mode: ${{ inputs.mode }}

  apk:
    if: contains(inputs.platforms, 'apk' || contains(inputs.platforms, 'android'))
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: apk
      os: ubuntu-latest
      mode: ${{ inputs.mode }}

  ios:
    if: contains(inputs.platforms, 'ios')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: ios
      os: macos-latest
      mode: ${{ inputs.mode }}

  web:
    if: contains(inputs.platforms, 'web')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: web
      os: ubuntu-latest
      mode: ${{ inputs.mode }}
