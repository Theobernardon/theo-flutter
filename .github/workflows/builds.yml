name: Builder Flutter Workflow Réutilisable

on:
  workflow_call:
    # Map the workflow outputs to job outputs
    inputs:
      platforms:
        required: true
        type: string
        description: "Liste des plateformes à builder, séparées par des virgules (ex: apk, ios, web)"

jobs:
  Build-windows:
    if: contains(inputs.platforms, 'windows')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: windows
      os: windows-latest
      path: build\windows\x64\runner\Release\

  Build-linux:
    if: contains(inputs.platforms, 'linux')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: linux
      os: ubuntu-latest
      path: build/linux/x64/release/bundle/

  Build-macos:
    if: contains(inputs.platforms, 'macos')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: macos
      os: macos-latest
      path: build/macos/Build/**/*.app # a tester

  Build-apk:
    if: contains(inputs.platforms, 'apk' || contains(inputs.platforms, 'android'))
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: apk
      os: ubuntu-latest
      path: build/app/outputs/flutter-apk/ # a tester

  Build-ios:
    if: contains(inputs.platforms, 'ios')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: ios
      os: macos-latest
      path: build/ios/iphoneos/*.ipa # a tester

  Build-web:
    if: contains(inputs.platforms, 'web')
    uses: Theobernardon/theo-flutter/.github/workflows/build-blueprint.yml@test
    with:
      platform: web
      os: ubuntu-latest
      path: build/web # a tester
